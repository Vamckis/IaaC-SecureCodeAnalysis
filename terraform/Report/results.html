<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>KICS Scan Result</title><style>*{margin:0;padding:0;outline:0;box-sizing:border-box}body{font-family:sans-serif}.container{display:flex;align-items:center;flex-direction:column;margin:5px;border:1px solid #bebebe}.run-info{display:flex;flex-wrap:wrap;border:1px solid #bebebe;margin-top:10px;width:50vw}.run-info>span{flex-basis:50%;text-align:center}.counters{display:flex;flex-direction:row;margin:22px 0}.report-header-footer{display:flex;flex-direction:row;justify-content:space-between;border-bottom:1px solid #bebebe;width:100%;padding:15px 21px;background-color:#503e9e;height:50px;font-weight:700;font-size:14px;color:#fff;cursor:default;user-select:none}.report-header-footer>a{color:inherit;text-decoration:inherit}.report-header-footer>.title{font-size:18px}.report-header-footer>.title>span{color:#000}.report-header-footer>.timestamp{font-weight:400;font-style:italic;opacity:.5}.severity{display:flex;flex-direction:column;cursor:pointer;position:relative;margin:0 22px;align-items:center}.severity>.caption.selected{text-decoration:underline overline}.badge{color:#fff;border:2px solid #e8e8e8;border-radius:50%;cursor:default;user-select:none;padding:3px;font-size:10px;display:flex;align-items:center;justify-content:center;width:30px;height:30px;position:absolute;left:60%;top:50%}.kics-orange{color:#fc6e3a}.kics-orange>svg{fill:#fc6e3a}.kics-orange~.badge{background-color:#503e9e}.kics-purple{color:#503e9e}.kics-purple>svg{fill:#503e9e}.kics-purple~.badge{background-color:#fc6e3a}.severity>.icon>svg{width:80px;height:auto}.severity>.caption{font-size:16px;font-weight:bolder;user-select:none;cursor:default}.separator{border-top:1px solid #979797;opacity:.5;width:95%;margin:22px 0}.query{width:95vw}.query-title{display:flex;align-items:flex-start;flex-direction:column;width:100%}.query-title>h2{display:flex}.query-title>h2>div{width:20px;margin-right:12px;margin-left:-30px}.query>*{margin-left:30px}.query-info{display:flex;flex-direction:column;justify-content:space-between}.query-details{margin:12px 0;display:flex;flex-direction:column;text-align:justify}.query-details>span.query-description-title{font-size:18px;margin-top:5px}.query-details>span.cis-description-text{margin-top:5px}.query-details>span:last-child{font-size:14px}.vulnerable-info{border:1px #969696 solid;border-radius:2px;display:flex;flex-direction:column;margin:6px 9px}.vulnerable-info-header{display:flex;flex-direction:row;justify-content:space-between;margin:6px 9px}.vulnerable-info-details{display:flex;flex-direction:column;margin:6px 9px}.vulnerable-info-details>span>strong{width:5vw}.code-box{display:flex;flex-direction:column;background-color:#503e9e10}.code-line{display:flex;flex-direction:row;align-items:center;height:20px}.code-box>.error{background-color:#fc6e3a50}.code-line>.code-line-counter{font-size:10px;margin-left:9px;margin-right:10vw}.code-line>.code{font-family:monospace;font-size:16px}.kics-message{margin:24px 30vw;text-align:center}.love{color:#503e9d;font-style:italic}.social-networks{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-bottom:24px}.social-networks>a{margin:0 15px}.social-networks>a>div>svg{width:20px;height:20px}.footer-text{font-style:italic;opacity:.5;font-weight:400;width:100%;display:flex;align-self:center;justify-content:center}a.checkmarx,a.checkmarx:visited,a.checkmarx:hover,a.checkmarx:active{cursor:pointer;font-weight:700;text-decoration:underline;color:#fff;opacity:.8}.hide{display:none}summary{cursor:pointer;user-select:none;font-size:18px;font-weight:700}</style><script>function filter(e){const t=document.querySelectorAll("[data-type='severity']");t.forEach(t=>e!=="TOTAL"&&e!==t.getAttribute("data-name")?t.classList.add("hide"):t.classList.remove("hide"));const n=document.querySelectorAll(".severity > .caption");n.forEach(t=>e&&e===t.innerText?t.classList.add("selected"):t.classList.remove("selected"))}</script></head><body><div class="container"><div class="report-header-footer"><span class="title">KICS <span>REPORT</span></span><span class="timestamp">11/01/2022 12:37</span><a href="https://www.kics.io/" rel="noopener" target="_blank">KICS.IO</a></div><div class="run-info"><span style="flex-basis:100%" id="scan-paths"><strong>KICS 1.5.1</strong></span>
<span style="flex-basis:100%" id="scan-paths"><strong>Scanned paths:</strong> .</span>
<span style="flex-basis:100%" id="scan-platforms"><strong>Platforms:</strong> Terraform, Dockerfile, Common</span><span id="scan-start-time"><strong>Start time:</strong> 12:37:02, Nov 01 2022</span>
<span id="scan-end-time"><strong>End time:</strong> 12:37:15, Nov 01 2022</span></div><h2 style="margin-top:41px" class="kics-orange">Vulnerabilities:</h2><div class="counters"><div class="severity" onclick="filter('HIGH')"><div class="kics-orange icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="badge" id="severity-count-high">74</span>
<span class="caption">HIGH</span></div><div class="severity" onclick="filter('MEDIUM')"><div class="kics-orange icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="badge" id="severity-count-medium">53</span>
<span class="caption">MEDIUM</span></div><div class="severity" onclick="filter('LOW')"><div class="kics-purple icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="badge" id="severity-count-low">21</span>
<span class="caption">LOW</span></div><div class="severity" onclick="filter('INFO')"><div class="kics-purple icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="badge" id="severity-count-info">43</span>
<span class="caption">INFO</span></div><div class="severity" onclick="filter('TOTAL')"><div class="kics-orange icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="badge" id="severity-count-total">191</span>
<span class="caption selected">TOTAL</span></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">AD Admin Not Configured For SQL Server</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">The Active Directory Administrator is not configured for a SQL server</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_active_directory_administrator" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_active_directory_administrator</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> A 'azurerm_sql_active_directory_administrator' is defined for 'azurerm_sql_server[example]'</span>
<span><strong>Found:</strong> A 'azurerm_sql_active_directory_administrator' is not defined for 'azurerm_sql_server[example]'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "azurerm_sql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">App Service Managed Identity Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Resource Management</span></span></div><div class="query-details"><span class="query-description-title">Azure App Service should have managed identity enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service1].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service1].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource azurerm_app_service "app-service1" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service2].identity' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service2].identity' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource azurerm_app_service "app-service2" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">App Service Not Using Latest TLS Encryption Version</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Ensure App Service is using the latest version of TLS encryption</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service1].site_config.min_tls_version' is set to '1.2'</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service1].site_config.min_tls_version' is not set to '1.2'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"> site_config {</span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code"> min_tls_version = "1.1"</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Authentication Without MFA</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 1.10</sub></span>
<span class="query-description-title">Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</span>
<span class="cis-description-text">Multi-Factor Authentication (MFA) adds an extra layer of authentication assurance beyond traditional credentials. With MFA enabled, when a user signs in to the AWS Console, they will be prompted for their user name and password as well as for an authentication code from their physical or virtual MFA token. It is recommended that MFA be enabled for all accounts that have a console password.
Enabling MFA provides increased security for console access as it requires the authenticating principal to possess a device that displays a time-sensitive key and have knowledge of a credential.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/iam.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attributes 'policy.Statement.Condition', 'policy.Statement.Condition.BoolIfExists', and 'policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent' are defined and not null</span>
<span><strong>Found:</strong> The attribute(s) 'policy.Statement.Condition' or/and 'policy.Statement.Condition.BoolIfExists' or/and 'policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent' is/are undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Azure App Service Client Certificate Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Azure App Service client certificate should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service2].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service2].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource azurerm_app_service "app-service2" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service1].client_cert_enabled' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service1].client_cert_enabeld' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource azurerm_app_service "app-service1" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">BigQuery Dataset Is Public</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">BigQuery dataset is anonymously or publicly accessible</span><span><a href="https://www.terraform.io/docs/providers/google/r/bigquery_dataset.html" rel="noopener" target="_blank">https://www.terraform.io/docs/providers/google/r/bigquery_dataset.html</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/big_data.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'access.special_group' is not equal to 'allAuthenticatedUsers'</span>
<span><strong>Found:</strong> 'access.special_group' is equal to 'allAuthenticatedUsers'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"> access {</span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code"> special_group = "allAuthenticatedUsers"</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> role = "READER"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">CMK Rotation Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.8</sub></span>
<span class="query-description-title">Ensure rotation for customer created CMKs is enabled</span>
<span class="cis-description-text">AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled.
Rotating encryption keys helps reduce the potential impact of a compromised key as data encrypted with a new key cannot be accessed with a previous key that may have been exposed.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/kms.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_kms_key[logs_key].enable_key_rotation is set to true</span>
<span><strong>Found:</strong> aws_kms_key[logs_key].enable_key_rotation is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_kms_key" "logs_key" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # key does not have rotation enabled</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> description = "${local.resource_prefix.value}-logs bucket key"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">COS Node Image Not Used</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">The node image should be Container-Optimized OS(COS)</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#node_config" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#node_config</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'node_config.image_type' should start with 'COS'</span>
<span><strong>Found:</strong> 'node_config.image_type' does not start with 'COS'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"> node_config {</span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code"> image_type = "Ubuntu"</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Client Certificate Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Clusters must be created with Client Certificate enabled, which means 'master_auth' must have 'client_certificate_config' with the attribute 'issue_client_certificate' equal to true</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'master_auth' is defined</span>
<span><strong>Found:</strong> Attribute 'master_auth' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Cloud Storage Bucket Logging Not Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Cloud storage bucket with logging not enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#log_bucket" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#log_bucket</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gcs.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_storage_bucket.logging' is set</span>
<span><strong>Found:</strong> 'google_storage_bucket.logging' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "google_storage_bucket" "terragoat_website" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terragot-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> force_destroy = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Cloud Storage Bucket Versioning Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Object Versioning Not Enabled on Cloud Storage Bucket</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gcs.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is defined and not null</span>
<span><strong>Found:</strong> 'versioning' it undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "google_storage_bucket" "terragoat_website" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terragot-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> force_destroy = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Cluster Labels Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Clusters must be configured with labels, which means the attribute 'resource_labels' must be defined</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'resource_labels' is defined</span>
<span><strong>Found:</strong> Attribute 'resource_labels' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Cluster Master Authentication Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'master_auth' must have the subattributes 'username' and 'password' defined and not empty</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'master_auth' is defined</span>
<span><strong>Found:</strong> Attribute 'master_auth' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">DB Instance Publicly Accessible</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">The field 'publicly_accessible' should not be set to 'true' (default is 'false').</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#publicly_accessible" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#publicly_accessible</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'publicly_accessible' is set to false or undefined</span>
<span><strong>Found:</strong> 'publicly_accessible' is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"> monitoring_interval = 0</span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> publicly_accessible = true</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">DB Instance Storage Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">The parameter storage_encrypted in aws_db_instance must be set to 'true' (the default is 'false').</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' is set to true</span>
<span><strong>Found:</strong> 'storage_encrypted' is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"> backup_retention_period = 0</span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code"> storage_encrypted = false</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> skip_final_snapshot = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EBS Volume Snapshot Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">The value on AWS EBS Volume Snapshot Encryptation must be true</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ebs_snapshot#encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ebs_snapshot#encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 53</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_ebs_volume[web_host_storage].encrypted' associated with aws_ebs_snapshot[example_snapshot] is set</span>
<span><strong>Found:</strong> 'aws_ebs_volume[web_host_storage].encrypted' associated with aws_ebs_snapshot[example_snapshot] is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">52</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">53</span><span class="code">resource "aws_ebs_snapshot" "example_snapshot" {</span></div><div class="code-line"><span class="code-line-counter">54</span><span class="code"> # ebs snapshot without encryption</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EC2 Instance Has Public IP</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">EC2 Instance should not have a public IP address.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_instance" "web_host" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # ec2 have plain text secrets in user data</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> ami = "${var.ami}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 242</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'associate_public_ip_address' is defined and not null</span>
<span><strong>Found:</strong> 'associate_public_ip_address' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">241</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">242</span><span class="code">resource "aws_instance" "db_app" {</span></div><div class="code-line"><span class="code-line-counter">243</span><span class="code"> # ec2 have plain text secrets in user data</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">EKS Cluster Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">EKS Cluster should be encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 117</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encryption_config' is defined and not null</span>
<span><strong>Found:</strong> 'encryption_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">116</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">117</span><span class="code">resource aws_eks_cluster "eks_cluster" {</span></div><div class="code-line"><span class="code-line-counter">118</span><span class="code"> name = local.eks_name.value</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">GKE Basic Authentication Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">GCP - Google Kubernetes Engine (GKE) Basic Authentication must be disabled, which means the username and password provided in the master_auth block must be empty</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'master_auth' is defined</span>
<span><strong>Found:</strong> Attribute 'master_auth' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">GKE Legacy Authorization Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'enable_legacy_abac' must not be true</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'enable_legacy_abac' is false</span>
<span><strong>Found:</strong> Attribute 'enable_legacy_abac' is true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> enable_legacy_abac = true</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> monitoring_service = "none"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Geo Redundancy Is Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Backup</span></span></div><div class="query-details"><span class="query-description-title">Make sure that on PostgreSQL Geo Redundant Backups is enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 80</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is true</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server.example.geo_redundant_backup_enabled' is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">79</span><span class="code"> backup_retention_days = 7</span></div><div class="code-line error"><span class="code-line-counter">80</span><span class="code"> geo_redundant_backup_enabled = false</span></div><div class="code-line"><span class="code-line-counter">81</span><span class="code"> auto_grow_enabled = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">HTTP Port Open</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">The HTTP port is open in a Security Group</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 77</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group.ingress doesn't open the HTTP port (80)</span>
<span><strong>Found:</strong> aws_security_group.ingress opens the HTTP port (80)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">76</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">77</span><span class="code">resource "aws_security_group" "web-node" {</span></div><div class="code-line"><span class="code-line-counter">78</span><span class="code"> # security group is open to the world in SSH port</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">IAM Database Auth Not Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">IAM Database Auth Enabled must be configured to true</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#iam_database_authentication_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#iam_database_authentication_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'iam_database_authentication_enabled' is set to true</span>
<span><strong>Found:</strong> 'iam_database_authentication_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = var.dbname</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">IP Aliasing Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribut 'ip_allocation_policy' must be defined and, if defined, the attribute 'networking_mode' must be VPC_NATIVE </span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attributes 'ip_allocation_policy' and 'networking_mode' are defined</span>
<span><strong>Found:</strong> Attributes 'ip_allocation_policy' and 'networking_mode' are undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Key Expiration Not Set</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for all keys the expiration date is set</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/key_vault.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'expiration_date' exists</span>
<span><strong>Found:</strong> 'expiration_date' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource "azurerm_key_vault_key" "generated" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> name = "terragoat-generated-certificate-${var.environment}"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Missing User Instruction</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Dockerfile</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Build Process</span></span></div><div class="query-details"><span class="query-description-title">A user should be specified in the dockerfile, otherwise the image will run as root</span><span><a href="https://docs.docker.com/engine/reference/builder/#user" rel="noopener" target="_blank">https://docs.docker.com/engine/reference/builder/#user</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/resources/Dockerfile</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The 'Dockerfile' contains the 'USER' instruction</span>
<span><strong>Found:</strong> The 'Dockerfile' does not contain any 'USER' instruction</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">FROM python:3.7-slim</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">MySQL SSL Connection Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 60</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mysql_server.example.ssl_enforcement_enabled' is equal 'true'</span>
<span><strong>Found:</strong> 'azurerm_mysql_server.example.ssl_enforcement_enabled' is equal 'false'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">59</span><span class="code"> public_network_access_enabled = true</span></div><div class="code-line error"><span class="code-line-counter">60</span><span class="code"> ssl_enforcement_enabled = false</span></div><div class="code-line"><span class="code-line-counter">61</span><span class="code"> tags = {</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">MySQL Server Public Access Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">MySQL Server public access should be disabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 59</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mysql_server[example].public_network_access_enabled' is set to false</span>
<span><strong>Found:</strong> 'azurerm_mysql_server[example].public_network_access_enabled' is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">58</span><span class="code"> infrastructure_encryption_enabled = true</span></div><div class="code-line error"><span class="code-line-counter">59</span><span class="code"> public_network_access_enabled = true</span></div><div class="code-line"><span class="code-line-counter">60</span><span class="code"> ssl_enforcement_enabled = false</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Network Policy Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'network_policy.enabled' must be true and the attribute 'addons_config.network_policy_config.disabled' must be false </span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'network_policy' is defined and Attribute 'addons_config' is defined</span>
<span><strong>Found:</strong> Attribute 'network_policy' is undefined or Attribute 'addons_config' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Network Watcher Flow Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Check if enable field in the resource azurerm_network_watcher_flow_log is false.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/networking.tf</strong>
<span>Line 126</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> azurerm_network_watcher_flow_log.enabled is true</span>
<span><strong>Found:</strong> azurerm_network_watcher_flow_log.enabled is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">125</span><span class="code">resource azurerm_network_watcher_flow_log "flow_log" {</span></div><div class="code-line error"><span class="code-line-counter">126</span><span class="code"> enabled = false</span></div><div class="code-line"><span class="code-line-counter">127</span><span class="code"> network_security_group_id = azurerm_network_security_group.bad_sg.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Node Auto Upgrade Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Resource Management</span></span></div><div class="query-details"><span class="query-description-title">Node 'auto_upgrade' should be enabled for Kubernetes Clusters</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_upgrade" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_upgrade</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> google_container_node_pool.management is defined and not null</span>
<span><strong>Found:</strong> google_container_node_pool.management is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource google_container_node_pool "custom_node_pool" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> cluster = google_container_cluster.workload_cluster.name</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Passwords And Secrets - AWS Access Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Common</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Query to find passwords and secrets in infrastructure code.</span><span><a href="https://kics.io/" rel="noopener" target="_blank">https://kics.io/</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> 'export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code">sudo systemctl enable apache2</span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code">export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code">export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/lambda.tf</strong>
<span>Line 44</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' access_key = "AKIAIOSFODNN7EXAMPLE"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">43</span><span class="code"> variables = {</span></div><div class="code-line error"><span class="code-line-counter">44</span><span class="code"> access_key = "AKIAIOSFODNN7EXAMPLE"</span></div><div class="code-line"><span class="code-line-counter">45</span><span class="code"> secret_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/providers.tf</strong>
<span>Line 10</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' access_key = "AKIAIOSFODNN7EXAMPLE"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">9</span><span class="code"> region = "us-west-1"</span></div><div class="code-line error"><span class="code-line-counter">10</span><span class="code"> access_key = "AKIAIOSFODNN7EXAMPLE"</span></div><div class="code-line"><span class="code-line-counter">11</span><span class="code"> secret_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Passwords And Secrets - AWS Secret Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Common</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Query to find passwords and secrets in infrastructure code.</span><span><a href="https://kics.io/" rel="noopener" target="_blank">https://kics.io/</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> 'export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code">export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA</span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code">export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEY</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code">export AWS_DEFAULT_REGION=us-west-2</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Passwords And Secrets - Generic Password</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Common</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Query to find passwords and secrets in infrastructure code.</span><span><a href="https://kics.io/" rel="noopener" target="_blank">https://kics.io/</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "Aa12345678"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"> administrator_login = "terragoat"</span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> administrator_login_password = "Aa12345678"</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> version = "9.5"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 15</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' administrator_login_password = "Aa12345678"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">14</span><span class="code"> administrator_login = "ariel"</span></div><div class="code-line error"><span class="code-line-counter">15</span><span class="code"> administrator_login_password = "Aa12345678"</span></div><div class="code-line"><span class="code-line-counter">16</span><span class="code"> tags = merge({</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Passwords And Secrets - Generic Secret</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Common</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Query to find passwords and secrets in infrastructure code.</span><span><a href="https://kics.io/" rel="noopener" target="_blank">https://kics.io/</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/lambda.tf</strong>
<span>Line 45</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' secret_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">44</span><span class="code"> access_key = "AKIAIOSFODNN7EXAMPLE"</span></div><div class="code-line error"><span class="code-line-counter">45</span><span class="code"> secret_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"</span></div><div class="code-line"><span class="code-line-counter">46</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/providers.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Hardcoded secret key should not appear in source</span>
<span><strong>Found:</strong> ' secret_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"' contains a secret</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"> access_key = "AKIAIOSFODNN7EXAMPLE"</span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code"> secret_key = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Pod Security Policy Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Clusters must have Pod Security Policy controller enabled, which means there must be a 'pod_security_policy_config' with the 'enabled' attribute equal to true</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'pod_security_policy_config' is defined</span>
<span><strong>Found:</strong> Attribute 'pod_security_policy_config' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">PostgreSQL Server Threat Detection Policy Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Resource Management</span></span></div><div class="query-details"><span class="query-description-title">PostgreSQL Server Threat Detection Policy should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#threat_detection_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#threat_detection_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 73</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is a defined object</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].threat_detection_policy' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">72</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">73</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">74</span><span class="code"> name = "terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Private Cluster Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'private_cluster_config' must be defined and the attributes 'enable_private_nodes' and 'enable_private_endpoint' must be true</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'private_cluster_config' is defined and not null</span>
<span><strong>Found:</strong> Attribute 'private_cluster_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket ACL Allows Read Or Write to All Users</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">S3 bucket with public READ/WRITE access</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'acl' is equal 'private'</span>
<span><strong>Found:</strong> 'acl' is equal 'public-read'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> bucket = "${local.resource_prefix.value}-data"</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> acl = "public-read"</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> force_destroy = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket Object Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.1</sub></span>
<span class="query-description-title">Ensure all S3 buckets employ encryption-at-rest</span>
<span class="cis-description-text">Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.
Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_object#server_side_encryption" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_object#server_side_encryption</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket_object.server_side_encryption is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket_object.server_side_encryption is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource "aws_s3_bucket_object" "data_object" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> bucket = aws_s3_bucket.data.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket SSE Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#server_side_encryption_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#server_side_encryption_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 66</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">65</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">66</span><span class="code">resource "aws_s3_bucket" "operations" {</span></div><div class="code-line"><span class="code-line-counter">67</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 271</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">270</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">271</span><span class="code">resource "aws_s3_bucket" "flowbucket" {</span></div><div class="code-line"><span class="code-line-counter">272</span><span class="code"> bucket = "${local.resource_prefix.value}-flowlogs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 91</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">90</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">91</span><span class="code">resource "aws_s3_bucket" "data_science" {</span></div><div class="code-line"><span class="code-line-counter">92</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "data" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # bucket is public</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'server_side_encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> 'server_side_encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "aws_s3_bucket" "financials" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> # bucket is not encrypted</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">S3 Bucket Without Enabled MFA Delete</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.3</sub></span>
<span class="query-description-title">Ensure MFA Delete is enable on S3 buckets</span>
<span class="cis-description-text">Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.
Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#mfa_delete" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#mfa_delete</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 271</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[flowbucket].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[flowbucket].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">270</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">271</span><span class="code">resource "aws_s3_bucket" "flowbucket" {</span></div><div class="code-line"><span class="code-line-counter">272</span><span class="code"> bucket = "${local.resource_prefix.value}-flowlogs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 71</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'mfa_delete' is set to true</span>
<span><strong>Found:</strong> 'mfa_delete' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">70</span><span class="code"> acl = "private"</span></div><div class="code-line error"><span class="code-line-counter">71</span><span class="code"> versioning {</span></div><div class="code-line"><span class="code-line-counter">72</span><span class="code"> enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[financials].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[financials].versioning is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "aws_s3_bucket" "financials" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 118</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'mfa_delete' is set to true</span>
<span><strong>Found:</strong> 'mfa_delete' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">117</span><span class="code"> acl = "log-delivery-write"</span></div><div class="code-line error"><span class="code-line-counter">118</span><span class="code"> versioning {</span></div><div class="code-line"><span class="code-line-counter">119</span><span class="code"> enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 95</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'mfa_delete' is set to true</span>
<span><strong>Found:</strong> 'mfa_delete' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">94</span><span class="code"> acl = "private"</span></div><div class="code-line error"><span class="code-line-counter">95</span><span class="code"> versioning {</span></div><div class="code-line"><span class="code-line-counter">96</span><span class="code"> enabled = true</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_s3_bucket[data].versioning is defined and not null</span>
<span><strong>Found:</strong> aws_s3_bucket[data].versioning is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "data" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # bucket is public</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> # bucket is not encrypted</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">SQL DB Instance Backup Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Backup</span></span></div><div class="query-details"><span class="query-description-title">Checks if backup configuration is enabled for all Cloud SQL Database instances</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/big_data.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> settings.backup_configuration.enabled is true</span>
<span><strong>Found:</strong> settings.backup_configuration.enabled is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"> backup_configuration {</span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code"> enabled = false</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">SQL DB Instance Is Publicly Accessible</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Check if any Cloud SQL instances are publicly accessible.</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/big_data.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'authorized_network' address is trusted</span>
<span><strong>Found:</strong> 'authorized_network' address is not restricted: '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"> name = "WWW"</span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code"> value = "0.0.0.0/0"</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">SQL DB Instance With SSL Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Cloud SQL Database Instance should have SLL enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#require_ssl" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#require_ssl</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/big_data.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'settings.ip_configuration.require_ssl' is defined and not null</span>
<span><strong>Found:</strong> 'settings.ip_configuration.require_ssl' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"> tier = "db-f1-micro"</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code"> ip_configuration {</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> ipv4_enabled = true</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">SSL Enforce Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 85</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server.example.ssl_enforcement_enabled' is equal 'true'</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server.example.ssl_enforcement_enabled' is equal 'false'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">84</span><span class="code"> version = "9.5"</span></div><div class="code-line error"><span class="code-line-counter">85</span><span class="code"> ssl_enforcement_enabled = false</span></div><div class="code-line"><span class="code-line-counter">86</span><span class="code"> tags = {</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Secret Expiration Not Set</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for all secrets the expiration date is set</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/key_vault.tf</strong>
<span>Line 58</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'expiration_date' exists</span>
<span><strong>Found:</strong> 'expiration_date' is missing</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">57</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">58</span><span class="code">resource "azurerm_key_vault_secret" "secret" {</span></div><div class="code-line"><span class="code-line-counter">59</span><span class="code"> key_vault_id = azurerm_key_vault.example.id</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Security Group With Unrestricted Access To SSH</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">'SSH' (TCP:22) should not be public in AWS Security Group</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[web-node] 'SSH' (Port:22) is not public</span>
<span><strong>Found:</strong> aws_security_group[web-node] 'SSH' (Port:22) is public</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"> protocol = "tcp"</span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code"> cidr_blocks = [</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code"> "0.0.0.0/0"]</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Stackdriver Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'logging_service' must be defined and different from 'none'</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'logging_service' is not 'none'</span>
<span><strong>Found:</strong> Attribute 'logging_service' is 'none'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Stackdriver Monitoring Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoring_service' must be defined and different than 'none'</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Attribute 'monitoring_service' is not 'none'</span>
<span><strong>Found:</strong> Attribute 'monitoring_service' is 'none'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code">resource "google_container_cluster" "workload_cluster" {</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> name = "terragoat-${var.environment}-cluster"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Storage Account Not Forcing HTTPS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">See that Storage Accounts forces the use of HTTPS</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/storage.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account.example.enable_https_traffic_only' equals 'true'</span>
<span><strong>Found:</strong> 'azurerm_storage_account.example.enable_https_traffic_only' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = "tgsa${var.environment}${random_integer.rnd_int.result}"</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Trusted Microsoft Services Not Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Trusted MIcrosoft Services are not enabled for Storage Account access</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/storage.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'network_rules' is defined and not null</span>
<span><strong>Found:</strong> 'network_rules' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = "tgsa${var.environment}${random_integer.rnd_int.result}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/storage.tf</strong>
<span>Line 68</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'bypass' contains 'AzureServices'</span>
<span><strong>Found:</strong> 'bypass' does not contain 'AzureServices'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">67</span><span class="code"> ip_rules = ["127.0.0.1"]</span></div><div class="code-line error"><span class="code-line-counter">68</span><span class="code"> bypass = ["Metrics"]</span></div><div class="code-line"><span class="code-line-counter">69</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Unknown Port Exposed To Internet</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">AWS Security Group should not have an unknown port exposed to the entire Internet</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 87</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[web-node].ingress.from_port is known</span>
<span><strong>Found:</strong> aws_security_group[web-node].ingress.from_port is unknown and is exposed to the entire Internet</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">86</span><span class="code"> protocol = "tcp"</span></div><div class="code-line error"><span class="code-line-counter">87</span><span class="code"> cidr_blocks = [</span></div><div class="code-line"><span class="code-line-counter">88</span><span class="code"> "0.0.0.0/0"]</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Unrestricted Security Group Ingress</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Security groups allow ingress from 0.0.0.0:0</span><span><a href="https://www.terraform.io/docs/providers/aws/r/security_group.html" rel="noopener" target="_blank">https://www.terraform.io/docs/providers/aws/r/security_group.html</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 88</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">87</span><span class="code"> cidr_blocks = [</span></div><div class="code-line error"><span class="code-line-counter">88</span><span class="code"> "0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">89</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 95</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'</span>
<span><strong>Found:</strong> One of 'ingress.cidr_blocks' equal '0.0.0.0/0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">94</span><span class="code"> cidr_blocks = [</span></div><div class="code-line error"><span class="code-line-counter">95</span><span class="code"> "0.0.0.0/0"]</span></div><div class="code-line"><span class="code-line-counter">96</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Vault Auditing Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Ensure that logging for Azure KeyVault is 'Enabled'</span><span><a href="https://www.terraform.io/docs/providers/azurerm/r/key_vault.html" rel="noopener" target="_blank">https://www.terraform.io/docs/providers/azurerm/r/key_vault.html</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/key_vault.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_key_vault' is associated with 'azurerm_monitor_diagnostic_setting'</span>
<span><strong>Found:</strong> 'azurerm_key_vault' is not associated with 'azurerm_monitor_diagnostic_setting'</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "azurerm_key_vault" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terragoat-key-${var.environment}${random_integer.rnd_int.result}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> location = azurerm_resource_group.example.location</span></div></div></div></details></div></div><div data-type="severity" data-name="HIGH"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M13,16h-2v-2h2V16z M13,12h-2V7h2V12z"/></g></svg></div><span class="query-name">Web App Accepting Traffic Other Than HTTPS</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Web app should only accept HTTPS traffic in Azure Web App Service.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#https_only" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#https_only</a></span></div></div><details><summary>Results (<span class="severity-partial-count-high">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 27</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service1].https_only' is set to true</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service1].https_only' is not set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">26</span><span class="code"> resource_group_name = azurerm_resource_group.example.name</span></div><div class="code-line error"><span class="code-line-counter">27</span><span class="code"> https_only = false</span></div><div class="code-line"><span class="code-line-counter">28</span><span class="code"> site_config {</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">AKS Disk Encryption Set ID Undefined</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Azure Container Service (AKS) should use Disk Encryption Set ID</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#disk_encryption_set_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#disk_encryption_set_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/aks.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].disk_encryption_set_id' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].disk_encryption_set_id' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource azurerm_kubernetes_cluster "k8s_cluster" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> dns_prefix = "terragoat-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> location = var.location</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">AKS Network Policy Misconfigured</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Check if the Azure Kubernetes Service doesn't have the proper network policy configuration.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/kubernetes_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/kubernetes_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/aks.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].network_profile' is set</span>
<span><strong>Found:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].network_profile' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource azurerm_kubernetes_cluster "k8s_cluster" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> dns_prefix = "terragoat-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> location = var.location</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">AKS RBAC Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#role_based_access_control" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#role_based_access_control</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/aks.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].role_based_access_control.enabled' is set to true</span>
<span><strong>Found:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].role_based_access_control.enabled' is not set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"> role_based_access_control {</span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code"> enabled = false</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Cloud Storage Anonymous or Publicly Accessible</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Cloud Storage Buckets must not be anonymously or publicly accessible, which means the attribute 'members' must not possess 'allUsers' or 'allAuthenticatedUsers'</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam#google_storage_bucket_iam_binding" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam#google_storage_bucket_iam_binding</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gcs.tf</strong>
<span>Line 18</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_storage_bucket_iam_binding[allow_public_read].members' does not have 'allUsers'</span>
<span><strong>Found:</strong> 'google_storage_bucket_iam_binding[allow_public_read].members' has 'allUsers'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">17</span><span class="code"> bucket = google_storage_bucket.terragoat_website.id</span></div><div class="code-line error"><span class="code-line-counter">18</span><span class="code"> members = ["allUsers"]</span></div><div class="code-line"><span class="code-line-counter">19</span><span class="code"> role = "roles/storage.objectViewer"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Disk Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'disk_encryption_key' must be defined and its sub attributes 'raw_key' or 'kms_key_self_link' must also be defined</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/instances.tf</strong>
<span>Line 36</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_compute_disk[unencrypted_disk].disk_encryption_key' is defined and not null</span>
<span><strong>Found:</strong> 'google_compute_disk[unencrypted_disk].disk_encryption_key' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">35</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">36</span><span class="code">resource google_compute_disk "unencrypted_disk" {</span></div><div class="code-line"><span class="code-line-counter">37</span><span class="code"> name = "terragoat-${var.environment}-disk"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">EBS Volume Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.2.1</sub></span>
<span class="query-description-title">Ensure EBS volume encryption is enabled</span>
<span class="cis-description-text">Elastic Compute Cloud (EC2) supports encryption at rest when using the Elastic Block Store (EBS) service. While disabled by default, forcing encryption at EBS volume creation is supported.
Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 34</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> One of 'aws_ebs_volume.encrypted' is defined</span>
<span><strong>Found:</strong> One of 'aws_ebs_volume.encrypted' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">33</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">34</span><span class="code">resource "aws_ebs_volume" "web_host_storage" {</span></div><div class="code-line"><span class="code-line-counter">35</span><span class="code"> # unencrypted volume</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ECR Image Tag Not Immutable</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">ECR should have an image tag be immutable</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ecr.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository.repository.image_tag_mutability is 'IMMUTABLE'</span>
<span><strong>Found:</strong> aws_ecr_repository.repository.image_tag_mutability is 'MUTABLE'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "${local.resource_prefix.value}-repository"</span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ECR Repository Not Encrypted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">ECR (Elastic Container Registry) Repository encryption should be set</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ecr.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'encryption_configuration' is defined and not null</span>
<span><strong>Found:</strong> The attribute 'encryption_configuration' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource aws_ecr_repository "repository" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "${local.resource_prefix.value}-repository"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ElasticSearch Not Encrypted At Rest</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Check if ElasticSearch encryption is disabled at Rest</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/es.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'encrypt_at_rest' is set and enabled</span>
<span><strong>Found:</strong> 'encrypt_at_rest' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "monitoring-framework" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "tg-${var.environment}-es"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "2.3"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Elasticsearch Domain Not Encrypted Node To Node</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Elasticsearch Domain encryption should be enabled node to node</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#node_to_node_encryption" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#node_to_node_encryption</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/es.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> The attribute 'node_to_node_encryption' is set to true</span>
<span><strong>Found:</strong> The attribute 'node_to_node_encryption' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "monitoring-framework" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "tg-${var.environment}-es"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "2.3"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Elasticsearch Domain With Vulnerable Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Elasticsearch Domain policy should avoid wildcard in 'Action' and 'Principal'.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain_policy#access_policies" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain_policy#access_policies</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/es.tf</strong>
<span>Line 42</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_elasticsearch_domain_policy[monitoring-framework-policy].access_policies does not have wildcard in 'Action' and 'Principal'</span>
<span><strong>Found:</strong> aws_elasticsearch_domain_policy[monitoring-framework-policy].access_policies has wildcard in 'Action' or 'Principal'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">41</span><span class="code"> domain_name = aws_elasticsearch_domain.monitoring-framework.domain_name</span></div><div class="code-line error"><span class="code-line-counter">42</span><span class="code"> access_policies = data.aws_iam_policy_document.policy.json</span></div><div class="code-line"><span class="code-line-counter">43</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Elasticsearch Log is disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">AWS Elasticsearch should have logs enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_publishing_options" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_publishing_options</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/es.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'log_publishing_options' is defined and not null</span>
<span><strong>Found:</strong> 'log_publishing_options' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "monitoring-framework" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "tg-${var.environment}-es"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "2.3"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Email Alerts Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that alerts notifications are set to 'On' in the Azure Security Center Contact</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/security_center.tf</strong>
<span>Line 6</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_contact.contact.alert_notifications' is true</span>
<span><strong>Found:</strong> 'azurerm_security_center_contact.contact.alert_notifications' is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">5</span><span class="code">resource azurerm_security_center_contact "contact" {</span></div><div class="code-line error"><span class="code-line-counter">6</span><span class="code"> alert_notifications = false</span></div><div class="code-line"><span class="code-line-counter">7</span><span class="code"> alerts_to_admins = false</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Encryption On Managed Disk Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Ensure that the encryption is active on the disk</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk#encryption_settings" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk#encryption_settings</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/storage.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> azurerm_managed_disk[example].encryption_settings.enabled is true</span>
<span><strong>Found:</strong> azurerm_managed_disk[example].encryption_settings.enabled is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> encryption_settings {</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> enabled = false</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Google Compute Network Using Firewall Rule that Allows All Ports</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Google Compute Network should not use a firewall rule that allows all ports</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/networks.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_compute_network[vpc]' is not using a firewall rule that allows access to all ports</span>
<span><strong>Found:</strong> 'google_compute_network[vpc]' is using a firewall rule that allows access to all ports</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource google_compute_network "vpc" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terragoat-${var.environment}-network"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> description = "Virtual vulnerable-by-design network"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Google Compute Subnetwork Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">This query checks if logs are enabled for a Google Compute Subnetwork resource.</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/networks.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_compute_subnetwork[public-subnetwork].log_config' is defined and not null</span>
<span><strong>Found:</strong> 'google_compute_subnetwork[public-subnetwork].log_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code">resource "google_compute_subnetwork" "public-subnetwork" {</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> name = "terragoat-${var.environment}-public-subnetwork"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Google Container Node Pool Auto Repair Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Verifies if Google Container Node Pool Auto Repair is Enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gke.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> google_container_node_pool[custom_node_pool].management.auto_repair is defined and not null</span>
<span><strong>Found:</strong> google_container_node_pool[custom_node_pool].management.auto_repair is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">resource google_container_node_pool "custom_node_pool" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> cluster = google_container_cluster.workload_cluster.name</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Google Storage Bucket Level Access Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Google Storage Bucket Level Access should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/gcs.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> google_storage_bucket[terragoat_website].uniform_bucket_level_access is defined and not null</span>
<span><strong>Found:</strong> google_storage_bucket[terragoat_website].uniform_bucket_level_access is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "google_storage_bucket" "terragoat_website" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terragot-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> force_destroy = true</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Access Analyzer Undefined</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">IAM Access Analyzer should be defined to identify unintentional access</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_accessanalyzer_analyzer' is set</span>
<span><strong>Found:</strong> 'aws_accessanalyzer_analyzer' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = var.dbname</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Access Key Is Exposed</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="cis-description-id"><sub>CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 1.11</sub></span>
<span class="query-description-title">Do not setup access keys during initial user setup for all IAM users that have a console password</span>
<span class="cis-description-text">AWS console defaults to no check boxes selected when creating a new IAM user. When cerating the IAM User credentials you have to determine what type of access they require. Programmatic access: The IAM user might need to make API calls, use the AWS CLI, or use the Tools for Windows PowerShell. In that case, create an access key (access key ID and a secret access key) for that user. AWS Management Console access: If the user needs to access the AWS Management Console, create a password for the user.
Requiring the additional steps be taken by the user for programmatic access after their profile has been created will give a stronger indication of intent that access keys are [a] necessary for their work and [b] once the access key is established on an account that the keys may be in use somewhere in the organization. Note : Even if it is known the user will need access keys, require them to create the keys themselves or put in a support ticket to have them created as a separate step from user creation.</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/iam.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_iam_access_key[user].user' is 'root' for an active access key</span>
<span><strong>Found:</strong> 'aws_iam_access_key[user].user' is '${aws_iam_user.user.name}' for an active access key</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code">resource "aws_iam_access_key" "user" {</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> user = aws_iam_user.user.name</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Policy Grants Full Permissions</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">IAM policies allow all ('*') in a statement action</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/iam.tf</strong>
<span>Line 29</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'policy.Statement.Resource' not equal '*'</span>
<span><strong>Found:</strong> 'policy.Statement.Resource' equal '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">29</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">30</span><span class="code">{</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 209</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'policy.Statement.Resource' not equal '*'</span>
<span><strong>Found:</strong> 'policy.Statement.Resource' equal '*'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">208</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">209</span><span class="code"> policy = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">210</span><span class="code">{</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Neptune Cluster With IAM Database Authentication Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Neptune Cluster should have IAM Database Authentication enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/neptune.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'iam_database_authentication_enabled' is set to true</span>
<span><strong>Found:</strong> 'iam_database_authentication_enabled' is set to false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"> skip_final_snapshot = true</span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code"> iam_database_authentication_enabled = false</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> apply_immediately = true</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Neptune Database Cluster Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Check if Neptune Cluster Storage is securely encrypted</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/neptune.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'storage_encrypted' should be true</span>
<span><strong>Found:</strong> 'storage_encrypted' is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> apply_immediately = true</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> storage_encrypted = false</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> tags = {</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">OSLogin Is Disabled For VM Instance</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Check if any VM instance disables OSLogin</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/instances.tf</strong>
<span>Line 21</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> google_compute_instance[server].metadata.enable-oslogin is true or undefined</span>
<span><strong>Found:</strong> google_compute_instance[server].metadata.enable-oslogin is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">20</span><span class="code"> block-project-ssh-keys = false</span></div><div class="code-line error"><span class="code-line-counter">21</span><span class="code"> enable-oslogin = false</span></div><div class="code-line"><span class="code-line-counter">22</span><span class="code"> serial-port-enable = true</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">PostgreSQL Log Checkpoints Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 109</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_configuration.example.value' should be 'ON'</span>
<span><strong>Found:</strong> 'azurerm_postgresql_configuration.example.value' is 'OFF'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">108</span><span class="code"> server_name = azurerm_postgresql_server.example.name</span></div><div class="code-line error"><span class="code-line-counter">109</span><span class="code"> value = "off"</span></div><div class="code-line"><span class="code-line-counter">110</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">PostgreSQL Server Without Connection Throttling</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Ensure that Connection Throttling is set for the PostgreSQL server</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 102</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_configuration.thrtottling_config.value' should be 'ON'</span>
<span><strong>Found:</strong> 'azurerm_postgresql_configuration.thrtottling_config.value' is 'OFF'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">101</span><span class="code"> server_name = azurerm_postgresql_server.example.name</span></div><div class="code-line error"><span class="code-line-counter">102</span><span class="code"> value = "off"</span></div><div class="code-line"><span class="code-line-counter">103</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Project-wide SSH Keys Are Enabled In VM Instances</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">VM Instance should block project-wide SSH keys</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/instances.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> google_compute_instance[server].metadata.block-project-ssh-keys is true</span>
<span><strong>Found:</strong> google_compute_instance[server].metadata.block-project-ssh-keys is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"> metadata = {</span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code"> block-project-ssh-keys = false</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> enable-oslogin = false</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">RDP Access Is Not Restricted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Check if Google Firewall ingress allows RDP access (port 3389)</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/networks.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_compute_firewall[allow_all].allow.ports' does not include RDP port 3389</span>
<span><strong>Found:</strong> 'google_compute_firewall[allow_all].allow.ports' includes RDP port 3389</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> protocol = "tcp"</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> ports = ["0-65535"]</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">RDS With Backup Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Backup</span></span></div><div class="query-details"><span class="query-description-title">RDS configured without backup</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 17</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'backup_retention_period' is not equal '0'</span>
<span><strong>Found:</strong> 'backup_retention_period' is equal '0'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">16</span><span class="code"> multi_az = false</span></div><div class="code-line error"><span class="code-line-counter">17</span><span class="code"> backup_retention_period = 0</span></div><div class="code-line"><span class="code-line-counter">18</span><span class="code"> storage_encrypted = false</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Role Definition Allows Custom Role Creation</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Role Definition should not allow custom role creation</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/roles.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> azurerm_role_definition[example].permissions.actions does not allow custom role creation</span>
<span><strong>Found:</strong> azurerm_role_definition[example].permissions.actions allows custom role creation</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> permissions {</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> actions = ["*"]</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> not_actions = []</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">S3 Bucket Without Versioning</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">S3 bucket should have versioning enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "data" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # bucket is public</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "aws_s3_bucket" "financials" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 271</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'versioning' is set to true</span>
<span><strong>Found:</strong> 'versioning' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">270</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">271</span><span class="code">resource "aws_s3_bucket" "flowbucket" {</span></div><div class="code-line"><span class="code-line-counter">272</span><span class="code"> bucket = "${local.resource_prefix.value}-flowlogs"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">SQL Server Auditing Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Make sure that for SQL Servers, 'Auditing' is set to 'On'</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_sql_server.example.extended_auditing_policy' exists</span>
<span><strong>Found:</strong> 'azurerm_sql_server.example.extended_auditing_policy' does not exist</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code">resource "azurerm_sql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code"> name = "terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">SSH Access Is Not Restricted</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Check if Google Firewall allows SSH access (port 22) from the Internet (public CIDR block)</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/networks.tf</strong>
<span>Line 25</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_compute_firewall[allow_all].allow.ports' does not include SSH port 22</span>
<span><strong>Found:</strong> 'google_compute_firewall[allow_all].allow.ports' includes SSH port 22</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">24</span><span class="code"> protocol = "tcp"</span></div><div class="code-line error"><span class="code-line-counter">25</span><span class="code"> ports = ["0-65535"]</span></div><div class="code-line"><span class="code-line-counter">26</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Security Center Pricing Tier Is Not Standard</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Make sure that the 'Standard' pricing tiers were selected.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/security_center.tf</strong>
<span>Line 2</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_security_center_subscription_pricing.pricing.tier' is 'Standard'</span>
<span><strong>Found:</strong> 'azurerm_security_center_subscription_pricing.pricing.tier' is 'Free'</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">1</span><span class="code">resource azurerm_security_center_subscription_pricing "pricing" {</span></div><div class="code-line error"><span class="code-line-counter">2</span><span class="code"> tier = "Free"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code">}</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Serial Ports Are Enabled For VM Instances</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Check if VM instance enables serial ports</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/instances.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> google_compute_instance[server].metadata.serial-port-enable is false or undefined</span>
<span><strong>Found:</strong> google_compute_instance[server].metadata.serial-port-enable is true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"> enable-oslogin = false</span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code"> serial-port-enable = true</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Small Activity Log Retention Period</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Ensure that Activity Log Retention is set 365 days or greater</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/logging.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_monitor_log_profile[logging_profile].retention_policy.days' is greater than or equal to 365 days or 0 (indefinitely)</span>
<span><strong>Found:</strong> 'azurerm_monitor_log_profile[logging_profile].retention_policy.days' is lesser than 365 days or different than 0 (indefinitely)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"> enabled = true</span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code"> days = 30</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Small Flow Logs Retention Period</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Flow logs enable capturing information about IP traffic flowing in and out of the network security groups. Network Security Group Flow Logs must be enabled with retention period greater than or equal to 90 days. This is important, because these logs are used to check for anomalies and give information of suspected breaches</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/networking.tf</strong>
<span>Line 133</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'flow_log.retention_policy.days' is bigger than 90)</span>
<span><strong>Found:</strong> 'retention_policy.days' is bigger than 90 [10])</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">132</span><span class="code"> enabled = false</span></div><div class="code-line error"><span class="code-line-counter">133</span><span class="code"> days = 10</span></div><div class="code-line"><span class="code-line-counter">134</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/networking.tf</strong>
<span>Line 132</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'flow_log.retention_policy' should be enabled)</span>
<span><strong>Found:</strong> 'flow_log.retention_policy' is disabled)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">131</span><span class="code"> retention_policy {</span></div><div class="code-line error"><span class="code-line-counter">132</span><span class="code"> enabled = false</span></div><div class="code-line"><span class="code-line-counter">133</span><span class="code"> days = 10</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Storage Account Not Using Latest TLS Encryption Version</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Ensure Storage Account is using the latest version of TLS encryption</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/storage.tf</strong>
<span>Line 23</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_storage_account[example].min_tls_version' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_storage_account[example].min_tls_version' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">22</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">23</span><span class="code">resource "azurerm_storage_account" "example" {</span></div><div class="code-line"><span class="code-line-counter">24</span><span class="code"> name = "tgsa${var.environment}${random_integer.rnd_int.result}"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Unscanned ECR Image</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">Checks if the ECR Image has been scanned</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#scan_on_push" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#scan_on_push</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ecr.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[repository].image_scanning_configuration is defined</span>
<span><strong>Found:</strong> aws_ecr_repository[repository].image_scanning_configuration is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource aws_ecr_repository "repository" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "${local.resource_prefix.value}-repository"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Using Default Service Account</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Instances must not be configured to use the Default Service Account, that has full access to all Cloud APIs, which means the attribute 'service_account' and its sub attribute 'email' must be defined. Additionally, 'email' must not be empty and must also not be a default Google Compute Engine service account.</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/instances.tf</strong>
<span>Line 3</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_compute_instance[server].service_account' is defined and not null</span>
<span><strong>Found:</strong> 'google_compute_instance[server].service_account' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">3</span><span class="code">resource google_compute_instance "server" {</span></div><div class="code-line"><span class="code-line-counter">4</span><span class="code"> machine_type = "n1-standard-1"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">VPC FlowLogs Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">VPC hasn't got any FlowLog associated</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[eks_vpc] is the same as Flow Logs VPC id</span>
<span><strong>Found:</strong> aws_vpc[eks_vpc] is not the same as Flow Logs VPC id</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource aws_vpc "eks_vpc" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">VPC Subnet Assigns Public IP</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">VPC Subnet should not assign public IP</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 93</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[eks_subnet2].map_public_ip_on_launch is set to false or undefined</span>
<span><strong>Found:</strong> aws_subnet[eks_subnet2].map_public_ip_on_launch is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">92</span><span class="code"> availability_zone = "${var.region}b"</span></div><div class="code-line error"><span class="code-line-counter">93</span><span class="code"> map_public_ip_on_launch = true</span></div><div class="code-line"><span class="code-line-counter">94</span><span class="code"> tags = merge({</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 139</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[web_subnet].map_public_ip_on_launch is set to false or undefined</span>
<span><strong>Found:</strong> aws_subnet[web_subnet].map_public_ip_on_launch is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">138</span><span class="code"> availability_zone = "${var.region}a"</span></div><div class="code-line error"><span class="code-line-counter">139</span><span class="code"> map_public_ip_on_launch = true</span></div><div class="code-line"><span class="code-line-counter">140</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 159</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[web_subnet2].map_public_ip_on_launch is set to false or undefined</span>
<span><strong>Found:</strong> aws_subnet[web_subnet2].map_public_ip_on_launch is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">158</span><span class="code"> availability_zone = "${var.region}b"</span></div><div class="code-line error"><span class="code-line-counter">159</span><span class="code"> map_public_ip_on_launch = true</span></div><div class="code-line"><span class="code-line-counter">160</span><span class="code"></span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 65</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[eks_subnet1].map_public_ip_on_launch is set to false or undefined</span>
<span><strong>Found:</strong> aws_subnet[eks_subnet1].map_public_ip_on_launch is set to true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">64</span><span class="code"> availability_zone = "${var.region}a"</span></div><div class="code-line error"><span class="code-line-counter">65</span><span class="code"> map_public_ip_on_launch = true</span></div><div class="code-line"><span class="code-line-counter">66</span><span class="code"> tags = merge({</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">VPC Without Network Firewall</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">VPC should have a Network Firewall associated</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkfirewall_firewall#vpc_id" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkfirewall_firewall#vpc_id</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 117</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[web_vpc] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[web_vpc] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">116</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">117</span><span class="code">resource "aws_vpc" "web_vpc" {</span></div><div class="code-line"><span class="code-line-counter">118</span><span class="code"> cidr_block = "172.16.0.0/16"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_vpc[eks_vpc] has an 'aws_networkfirewall_firewall' associated</span>
<span><strong>Found:</strong> aws_vpc[eks_vpc] does not have an 'aws_networkfirewall_firewall' associated</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource aws_vpc "eks_vpc" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> cidr_block = "10.10.0.0/16"</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Virtual Network with DDoS Protection Plan disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Availability</span></span></div><div class="query-details"><span class="query-description-title">Virtual Network should have DDoS Protection Plan enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_network#ddos_protection_plan" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_network#ddos_protection_plan</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/networking.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_virtual_network[example].ddos_protection_plan' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_virtual_network[example].ddos_protection_plan' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "azurerm_virtual_network" "example" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terragoat-vn-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> address_space = ["10.0.0.0/16"]</span></div></div></div></details></div></div><div data-type="severity" data-name="MEDIUM"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-orange"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">WAF Is Disabled For Azure Application Gateway</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Check if Web Application Firewall is disabled or not configured for Azure's Application Gateway.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/application_gateway" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/application_gateway</a></span></div></div><details><summary>Results (<span class="severity-partial-count-medium">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/application_gateway.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_application_gateway[network]' is set</span>
<span><strong>Found:</strong> 'azurerm_application_gateway[network]' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "azurerm_application_gateway" "network" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "example-appgateway"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> resource_group_name = "example-resourceGroup"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">AKS Private Cluster Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Azure Kubernetes Service (AKS) API should not be exposed to the internet</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#private_cluster_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#private_cluster_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/aks.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].private_cluster_enabled' is defined and set to true</span>
<span><strong>Found:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].private_cluster_enabled' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource azurerm_kubernetes_cluster "k8s_cluster" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> dns_prefix = "terragoat-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> location = var.location</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">AKS Uses Azure Policies Add-On Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">Azure Container Service (AKS) should use Azure Policies Add-On</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#azure_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#azure_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/aks.tf</strong>
<span>Line 14</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].addon_profile.azure_policy' is defined and set to true</span>
<span><strong>Found:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].addon_profile.azure_policy' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">13</span><span class="code"> }</span></div><div class="code-line error"><span class="code-line-counter">14</span><span class="code"> addon_profile {</span></div><div class="code-line"><span class="code-line-counter">15</span><span class="code"> oms_agent {</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">App Service HTTP2 Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">App Service should have 'http2_enabled' enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service2].site_config' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service2].site_config' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource azurerm_app_service "app-service2" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service1].site_config.http2_enabled' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service1].site_config.http2_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"> https_only = false</span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code"> site_config {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> min_tls_version = "1.1"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Dashboard Is Enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Check if the Kubernetes Dashboard is enabled.</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/aks.tf</strong>
<span>Line 19</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].addon_profile.kube_dashboard.enabled' is false or undefined</span>
<span><strong>Found:</strong> 'azurerm_kubernetes_cluster[k8s_cluster].addon_profile.kube_dashboard.enabled' is true</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">18</span><span class="code"> kube_dashboard {</span></div><div class="code-line error"><span class="code-line-counter">19</span><span class="code"> enabled = true</span></div><div class="code-line"><span class="code-line-counter">20</span><span class="code"> }</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">EC2 Instance Using API Keys</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">EC2 instances should use roles to be granted access to other AWS services</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#iam_instance_profile" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#iam_instance_profile</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 242</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[db_app] should be using iam_instance_profile to assign a role with permissions</span>
<span><strong>Found:</strong> aws_instance[db_app].user_data is being used to configure AWS API keys</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">241</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">242</span><span class="code">resource "aws_instance" "db_app" {</span></div><div class="code-line"><span class="code-line-counter">243</span><span class="code"> # ec2 have plain text secrets in user data</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_instance[web_host] should be using iam_instance_profile to assign a role with permissions</span>
<span><strong>Found:</strong> aws_instance[web_host].user_data is being used to configure AWS API keys</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_instance" "web_host" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # ec2 have plain text secrets in user data</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> ami = "${var.ami}"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">ECR Repository Without Policy</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">ECR Repository should have Policies attached to it</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ecr.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_ecr_repository[repository] has policies attached</span>
<span><strong>Found:</strong> aws_ecr_repository[repository] doesn't have policies attached</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource aws_ecr_repository "repository" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "${local.resource_prefix.value}-repository"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> image_tag_mutability = "MUTABLE"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">EKS cluster logging is not enabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Amazon EKS control plane logging is not enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 117</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enabled_cluster_log_types' is defined and not null</span>
<span><strong>Found:</strong> 'enabled_cluster_log_types' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">116</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">117</span><span class="code">resource aws_eks_cluster "eks_cluster" {</span></div><div class="code-line"><span class="code-line-counter">118</span><span class="code"> name = local.eks_name.value</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Google Compute Subnetwork with Private Google Access Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Networking and Firewall</span></span></div><div class="query-details"><span class="query-description-title">Google Compute Subnetwork should have 'private_ip_google_access' set to true</span><span><a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#private_ip_google_access" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#private_ip_google_access</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/networks.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'google_compute_subnetwork[public-subnetwork].private_ip_google_access' is defined and not null</span>
<span><strong>Found:</strong> 'google_compute_subnetwork[public-subnetwork].private_ip_google_access' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code">resource "google_compute_subnetwork" "public-subnetwork" {</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> name = "terragoat-${var.environment}-public-subnetwork"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Hardcoded AWS Access Key</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Secret Management</span></span></div><div class="query-details"><span class="query-description-title">Hard-coded AWS access key / secret key exists in EC2 user data</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 9</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'user_data' doesn't contain hardcoded access key</span>
<span><strong>Found:</strong> 'user_data' contains hardcoded access key</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">8</span><span class="code"> subnet_id = "${aws_subnet.web_subnet.id}"</span></div><div class="code-line error"><span class="code-line-counter">9</span><span class="code"> user_data = &lt;&lt;EOF</span></div><div class="code-line"><span class="code-line-counter">10</span><span class="code">#! /bin/bash</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Healthcheck Instruction Missing</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Dockerfile</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Insecure Configurations</span></span></div><div class="query-details"><span class="query-description-title">Ensure that HEALTHCHECK is being used. The HEALTHCHECK instruction tells Docker how to test a container to check that it is still working</span><span><a href="https://docs.docker.com/engine/reference/builder/#healthcheck" rel="noopener" target="_blank">https://docs.docker.com/engine/reference/builder/#healthcheck</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/resources/Dockerfile</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> Dockerfile contains instruction 'HEALTHCHECK'</span>
<span><strong>Found:</strong> Dockerfile doesn't contain instruction 'HEALTHCHECK'</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">FROM python:3.7-slim</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">IAM Policies Attached To User</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">IAM policies should be attached only to groups or roles</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy_attachment" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy_attachment</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/iam.tf</strong>
<span>Line 27</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'user' is redundant</span>
<span><strong>Found:</strong> 'user' exists</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">26</span><span class="code"> name = "excess_policy"</span></div><div class="code-line error"><span class="code-line-counter">27</span><span class="code"> user = "${aws_iam_user.user.name}"</span></div><div class="code-line"><span class="code-line-counter">28</span><span class="code"></span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Key Vault Secrets Content Type Undefined</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">Key Vault Secrets should have set Content Type</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/key_vault.tf</strong>
<span>Line 58</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_key_vault_secret[secret].content_type' is defined and not null</span>
<span><strong>Found:</strong> 'azurerm_key_vault_secret[secret].content_type' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">57</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">58</span><span class="code">resource "azurerm_key_vault_secret" "secret" {</span></div><div class="code-line"><span class="code-line-counter">59</span><span class="code"> key_vault_id = azurerm_key_vault.example.id</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">Lambda Functions Without X-Ray Tracing</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_Config.mode' should have the value 'Active'</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#tracing_config" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#tracing_config</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/lambda.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_lambda_function[analysis_lambda].tracing_config is defined and not null</span>
<span><strong>Found:</strong> aws_lambda_function[analysis_lambda].tracing_config is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code">resource "aws_lambda_function" "analysis_lambda" {</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> # lambda have plain text secrets in environment variables</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">PostgreSQL Server Infrastructure Encryption Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Encryption</span></span></div><div class="query-details"><span class="query-description-title">PostgreSQL Server Infrastructure Encryption should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#infrastructure_encryption_enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#infrastructure_encryption_enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 73</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is defined and set to true</span>
<span><strong>Found:</strong> 'azurerm_postgresql_server[example].infrastructure_encryption_enabled' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">72</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">73</span><span class="code">resource "azurerm_postgresql_server" "example" {</span></div><div class="code-line"><span class="code-line-counter">74</span><span class="code"> name = "terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}"</span></div></div></div></details></div></div><div data-type="severity" data-name="LOW"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><path d="M0,0h24v24H0V0z" fill="none"/></g><g><g><path d="M12,2L4,5v6.09c0,5.05,3.41,9.76,8,10.91c4.59-1.15,8-5.86,8-10.91V5L12,2z M18,11.09c0,4-2.55,7.7-6,8.83 c-3.45-1.13-6-4.82-6-8.83v-4.7l6-2.25l6,2.25V11.09z"/><rect height="2" width="2" x="11" y="14"/><rect height="5" width="2" x="11" y="7"/></g></g></svg></div><span class="query-name">S3 Bucket Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">S3 bucket without logging</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</a></span></div></div><details><summary>Results (<span class="severity-partial-count-low">5</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 115</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">114</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">115</span><span class="code">resource "aws_s3_bucket" "logs" {</span></div><div class="code-line"><span class="code-line-counter">116</span><span class="code"> bucket = "${local.resource_prefix.value}-logs"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource "aws_s3_bucket" "financials" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_s3_bucket" "data" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # bucket is public</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/s3.tf</strong>
<span>Line 66</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">65</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">66</span><span class="code">resource "aws_s3_bucket" "operations" {</span></div><div class="code-line"><span class="code-line-counter">67</span><span class="code"> # bucket is not encrypted</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 271</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'logging' is defined and not null</span>
<span><strong>Found:</strong> 'logging' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">270</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">271</span><span class="code">resource "aws_s3_bucket" "flowbucket" {</span></div><div class="code-line"><span class="code-line-counter">272</span><span class="code"> bucket = "${local.resource_prefix.value}-flowlogs"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">App Service Authentication Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Access Control</span></span></div><div class="query-details"><span class="query-description-title">Azure App Service authentication settings should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 51</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service2].auth_settings.enabled' is true</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service2].auth_settings.enabled' is false</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">50</span><span class="code"> auth_settings {</span></div><div class="code-line error"><span class="code-line-counter">51</span><span class="code"> enabled = false</span></div><div class="code-line"><span class="code-line-counter">52</span><span class="code"> }</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_app_service[app-service1].auth_settings' is defined</span>
<span><strong>Found:</strong> 'azurerm_app_service[app-service1].auth_settings' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource azurerm_app_service "app-service1" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">EC2 Instance Monitoring Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#monitoring" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#monitoring</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=web_host)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=web_host)</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_instance" "web_host" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # ec2 have plain text secrets in user data</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> ami = "${var.ami}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 242</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'monitoring' is defined and not null%!(EXTRA string=db_app)</span>
<span><strong>Found:</strong> 'monitoring' is undefined or null%!(EXTRA string=db_app)</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">241</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">242</span><span class="code">resource "aws_instance" "db_app" {</span></div><div class="code-line"><span class="code-line-counter">243</span><span class="code"> # ec2 have plain text secrets in user data</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">EC2 Not EBS Optimized</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs_optimized" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs_optimized</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 242</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">241</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">242</span><span class="code">resource "aws_instance" "db_app" {</span></div><div class="code-line"><span class="code-line-counter">243</span><span class="code"> # ec2 have plain text secrets in user data</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'ebs_optimized' is set to true</span>
<span><strong>Found:</strong> 'ebs_optimized' is undefined or null</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_instance" "web_host" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> # ec2 have plain text secrets in user data</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> ami = "${var.ami}"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">ELB Access Logging Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">ELB should have logging enabled to help on error investigation</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elb#enabled" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elb#enabled</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/elb.tf</strong>
<span>Line 2</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'aws_elb[{{weblb}}].access_logs' is defined and not null</span>
<span><strong>Found:</strong> 'aws_elb[{{weblb}}].access_logs' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">1</span><span class="code"># Create a new load balancer</span></div><div class="code-line error"><span class="code-line-counter">2</span><span class="code">resource "aws_elb" "weblb" {</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> name = "weblb-terraform-elb"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Name Is Not Snake Case</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">All names should follow snake case pattern.</span><span><a href="https://www.terraform.io/docs/extend/best-practices/naming.html#naming" rel="noopener" target="_blank">https://www.terraform.io/docs/extend/best-practices/naming.html#naming</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">10</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 33</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'policy_attachment-AmazonEKSClusterPolicy' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">32</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">33</span><span class="code">resource aws_iam_role_policy_attachment "policy_attachment-AmazonEKSClusterPolicy" {</span></div><div class="code-line"><span class="code-line-counter">34</span><span class="code"> policy_arn = "arn:aws:iam::aws:policy/AmazonEKSClusterPolicy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 22</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'app-service1' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">21</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">22</span><span class="code">resource azurerm_app_service "app-service1" {</span></div><div class="code-line"><span class="code-line-counter">23</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/policies.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'policy-res' is not in snake case</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "azurerm_policy_definition" "policy-res" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = "terragoat-policy-${var.environment}"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> policy_type = "Custom"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 231</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'web-eni' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">230</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">231</span><span class="code">resource "aws_network_interface" "web-eni" {</span></div><div class="code-line"><span class="code-line-counter">232</span><span class="code"> subnet_id = aws_subnet.web_subnet.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/networks.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'public-subnetwork' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code">resource "google_compute_subnetwork" "public-subnetwork" {</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> name = "terragoat-${var.environment}-public-subnetwork"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/app_service.tf</strong>
<span>Line 43</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'app-service2' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">42</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">43</span><span class="code">resource azurerm_app_service "app-service2" {</span></div><div class="code-line"><span class="code-line-counter">44</span><span class="code"> app_service_plan_id = azurerm_app_service_plan.example.id</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/es.tf</strong>
<span>Line 40</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'monitoring-framework-policy' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">39</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">40</span><span class="code">resource "aws_elasticsearch_domain_policy" "monitoring-framework-policy" {</span></div><div class="code-line"><span class="code-line-counter">41</span><span class="code"> domain_name = aws_elasticsearch_domain.monitoring-framework.domain_name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 77</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'web-node' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">76</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">77</span><span class="code">resource "aws_security_group" "web-node" {</span></div><div class="code-line"><span class="code-line-counter">78</span><span class="code"> # security group is open to the world in SSH port</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 38</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'policy_attachment-AmazonEKSServicePolicy' is not in snake case</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">37</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">38</span><span class="code">resource aws_iam_role_policy_attachment "policy_attachment-AmazonEKSServicePolicy" {</span></div><div class="code-line"><span class="code-line-counter">39</span><span class="code"> policy_arn = "arn:aws:iam::aws:policy/AmazonEKSServicePolicy"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/es.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> All names should be on snake case pattern</span>
<span><strong>Found:</strong> 'monitoring-framework' is not in snake case</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_elasticsearch_domain" "monitoring-framework" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> domain_name = "tg-${var.environment}-es"</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> elasticsearch_version = "2.3"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Neptune Logging Is Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">Neptune logging should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/neptune.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is defined</span>
<span><strong>Found:</strong> aws_neptune_cluster.enable_cloudwatch_logs_exports is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_neptune_cluster" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> cluster_identifier = var.neptune-dbname</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "neptune"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Output Without Description</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">All outputs should contain a valid description.</span><span><a href="https://www.terraform.io/docs/language/values/outputs.html#description-output-value-documentation" rel="noopener" target="_blank">https://www.terraform.io/docs/language/values/outputs.html#description-output-value-documentation</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">4</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/iam.tf</strong>
<span>Line 48</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">47</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">48</span><span class="code">output "username" {</span></div><div class="code-line"><span class="code-line-counter">49</span><span class="code"> value = aws_iam_user.user.name</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/iam.tf</strong>
<span>Line 52</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">51</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">52</span><span class="code">output "secret" {</span></div><div class="code-line"><span class="code-line-counter">53</span><span class="code"> value = aws_iam_access_key.user.encrypted_secret</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 146</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">145</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">146</span><span class="code">output "kubeconfig-certificate-authority-data" {</span></div><div class="code-line"><span class="code-line-counter">147</span><span class="code"> value = "${aws_eks_cluster.eks_cluster.certificate_authority.0.data}"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 142</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">141</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">142</span><span class="code">output "endpoint" {</span></div><div class="code-line"><span class="code-line-counter">143</span><span class="code"> value = "${aws_eks_cluster.eks_cluster.endpoint}"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">RDS Without Logging</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Observability</span></span></div><div class="query-details"><span class="query-description-title">RDS does not have any kind of logger</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#enabled_cloudwatch_logs_exports" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#enabled_cloudwatch_logs_exports</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 1</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'enabled_cloudwatch_logs_exports' is defined</span>
<span><strong>Found:</strong> 'enabled_cloudwatch_logs_exports' is undefined</span></div><div class="code-box"><div class="code-line error"><span class="code-line-counter">1</span><span class="code">resource "aws_db_instance" "default" {</span></div><div class="code-line"><span class="code-line-counter">2</span><span class="code"> name = var.dbname</span></div><div class="code-line"><span class="code-line-counter">3</span><span class="code"> engine = "mysql"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Resource Not Using Tags</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">AWS services resource tags are an essential part of managing components</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/resource-tagging" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/resource-tagging</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">2</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 66</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{eks_subnet1}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{eks_subnet1}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">65</span><span class="code"> map_public_ip_on_launch = true</span></div><div class="code-line error"><span class="code-line-counter">66</span><span class="code"> tags = merge({</span></div><div class="code-line"><span class="code-line-counter">67</span><span class="code"> Name = "${local.resource_prefix.value}-eks-subnet"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/eks.tf</strong>
<span>Line 94</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_subnet[{{eks_subnet2}}].tags has tags defined other than 'Name'</span>
<span><strong>Found:</strong> aws_subnet[{{eks_subnet2}}].tags has no tags defined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">93</span><span class="code"> map_public_ip_on_launch = true</span></div><div class="code-line error"><span class="code-line-counter">94</span><span class="code"> tags = merge({</span></div><div class="code-line"><span class="code-line-counter">95</span><span class="code"> Name = "${local.resource_prefix.value}-eks-subnet2"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">SQL Server Alert Email Disabled</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">SQL Server alert email should be enabled</span><span><a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/sql.tf</strong>
<span>Line 31</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'azurerm_mssql_server_security_alert_policy[example].email_account_admins' is defined</span>
<span><strong>Found:</strong> 'azurerm_mssql_server_security_alert_policy[example].email_account_admins' is undefined</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">30</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">31</span><span class="code">resource "azurerm_mssql_server_security_alert_policy" "example" {</span></div><div class="code-line"><span class="code-line-counter">32</span><span class="code"> resource_group_name = azurerm_resource_group.example.name</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Security Group Rules Without Description</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice for all rules in AWS Security Group to have a description</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">3</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 90</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{web-node}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{web-node}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">89</span><span class="code"> }</span></div><div class="code-line error"><span class="code-line-counter">90</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">91</span><span class="code"> from_port = 22</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 83</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{web-node}}].ingress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{web-node}}].ingress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">82</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">83</span><span class="code"> ingress {</span></div><div class="code-line"><span class="code-line-counter">84</span><span class="code"> from_port = 80</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/ec2.tf</strong>
<span>Line 97</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{web-node}}].egress description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{web-node}}].egress description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">96</span><span class="code"> }</span></div><div class="code-line error"><span class="code-line-counter">97</span><span class="code"> egress {</span></div><div class="code-line"><span class="code-line-counter">98</span><span class="code"> from_port = 0</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Security Group Without Description</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">It's considered a best practice for AWS Security Group to have a description</span><span><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description" rel="noopener" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">1</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/db-app.tf</strong>
<span>Line 116</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> aws_security_group[{{default}}] description is defined and not null</span>
<span><strong>Found:</strong> aws_security_group[{{default}}] description is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">115</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">116</span><span class="code">resource "aws_security_group" "default" {</span></div><div class="code-line"><span class="code-line-counter">117</span><span class="code"> name = "${local.resource_prefix.value}-rds-sg"</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Variable Without Description</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">All variables should contain a valid description.</span><span><a href="https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation" rel="noopener" target="_blank">https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">7</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/variables.tf</strong>
<span>Line 11</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">10</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">11</span><span class="code">variable "region" {</span></div><div class="code-line"><span class="code-line-counter">12</span><span class="code"> default = "us-central1"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 4</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">4</span><span class="code">variable "company_name" {</span></div><div class="code-line"><span class="code-line-counter">5</span><span class="code"> default = "acme"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 28</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">27</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">28</span><span class="code">variable ami {</span></div><div class="code-line"><span class="code-line-counter">29</span><span class="code"> type = "string"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code">variable "profile" {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> default = "default"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code">variable "environment" {</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> default = "dev"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">variable "region" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> default = "us-west-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/variables.tf</strong>
<span>Line 7</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'description' is defined and not null</span>
<span><strong>Found:</strong> 'description' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">6</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">7</span><span class="code">variable "location" {</span></div><div class="code-line"><span class="code-line-counter">8</span><span class="code"> type = string</span></div></div></div></details></div></div><div data-type="severity" data-name="INFO"><hr class="separator"><div class="query"><div class="query-info"><div class="query-title"><h2><div class="kics-purple"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><g><rect fill="none" height="24" width="24"/></g><g><g/><g><path d="M21,5l-9-4L3,5v6c0,5.55,3.84,10.74,9,12c2.3-0.56,4.33-1.9,5.88-3.71l-3.12-3.12c-1.94,1.29-4.58,1.07-6.29-0.64 c-1.95-1.95-1.95-5.12,0-7.07c1.95-1.95,5.12-1.95,7.07,0c1.71,1.71,1.92,4.35,0.64,6.29l2.9,2.9C20.29,15.69,21,13.38,21,11V5z"/><circle cx="12" cy="12" r="3"/></g></g></svg></div><span class="query-name">Variable Without Type</span></h2><span><strong>Platform:</strong> <span class="query-info-platform">Terraform</span></span>
<span><strong>Category:</strong> <span class="query-info-category">Best Practices</span></span></div><div class="query-details"><span class="query-description-title">All variables should contain a valid type.</span><span><a href="https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation" rel="noopener" target="_blank">https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation</a></span></div></div><details><summary>Results (<span class="severity-partial-count-info">6</span>)</summary><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: azure/variables.tf</strong>
<span>Line 12</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'type' is defined and not null</span>
<span><strong>Found:</strong> 'type' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">11</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">12</span><span class="code">variable "environment" {</span></div><div class="code-line"><span class="code-line-counter">13</span><span class="code"> default = "dev"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 24</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'type' is defined and not null</span>
<span><strong>Found:</strong> 'type' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">23</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">24</span><span class="code">variable "region" {</span></div><div class="code-line"><span class="code-line-counter">25</span><span class="code"> default = "us-west-2"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 8</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'type' is defined and not null</span>
<span><strong>Found:</strong> 'type' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">7</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">8</span><span class="code">variable "environment" {</span></div><div class="code-line"><span class="code-line-counter">9</span><span class="code"> default = "dev"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 4</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'type' is defined and not null</span>
<span><strong>Found:</strong> 'type' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">3</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">4</span><span class="code">variable "company_name" {</span></div><div class="code-line"><span class="code-line-counter">5</span><span class="code"> default = "acme"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: gcp/variables.tf</strong>
<span>Line 16</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'type' is defined and not null</span>
<span><strong>Found:</strong> 'type' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">15</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">16</span><span class="code">variable "environment" {</span></div><div class="code-line"><span class="code-line-counter">17</span><span class="code"> default = "dev"</span></div></div></div><div class="vulnerable-info"><div class="vulnerable-info-header"><strong>File: aws/consts.tf</strong>
<span>Line 20</span></div><div class="vulnerable-info-details"><span><strong>Expected:</strong> 'type' is defined and not null</span>
<span><strong>Found:</strong> 'type' is undefined or null</span></div><div class="code-box"><div class="code-line"><span class="code-line-counter">19</span><span class="code"></span></div><div class="code-line error"><span class="code-line-counter">20</span><span class="code">variable "profile" {</span></div><div class="code-line"><span class="code-line-counter">21</span><span class="code"> default = "default"</span></div></div></div></details></div></div><hr class="separator"><div class="kics-message">KICS is open and will always stay such. Both the scanning engine and the security queries are clear and open for the software development community.</div><div class="love">Spread the love:</div><div class="social-networks"><a href="https://github.com/Checkmarx/kics/" rel="noopener" target="_blank"><div><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
    <g fill="none" fill-rule="evenodd">
        <g fill="#626264" fill-rule="nonzero">
            <g>
                <g>
                    <path d="M13.172 19.5c2-.688 3.633-1.898 4.898-3.633 1.266-1.734 1.899-3.695 1.899-5.883 0-1.312-.25-2.586-.75-3.82S18 3.844 17.062 2.906C16.125 1.97 15.04 1.25 13.806.75 12.57.25 11.297 0 9.985 0c-1.313 0-2.587.25-3.82.75-1.235.5-2.321 1.219-3.259 2.156C1.97 3.844 1.25 4.93.75 6.164.25 7.398 0 8.672 0 9.984c0 2.188.633 4.149 1.898 5.883 1.266 1.735 2.915 2.945 4.946 3.633.218.031.383-.008.492-.117.11-.11.164-.242.164-.399v-1.687c-1.156.25-2.063.094-2.719-.469-.294-.214-.497-.463-.608-.746l-.048-.145c-.125-.343-.297-.64-.516-.89-.125-.188-.265-.328-.421-.422L3 14.485c-.25-.188-.375-.329-.375-.422 0-.094.078-.141.234-.141l.235-.047c.406.031.781.219 1.125.563.15.124.26.25.33.374l.045.094c.406.656.937 1.016 1.593 1.078.407.032.86-.046 1.36-.234.062-.594.266-1.047.61-1.36-1.376-.156-2.407-.53-3.095-1.124-.968-.813-1.453-2.079-1.453-3.797 0-1.031.344-1.922 1.032-2.672-.125-.281-.188-.594-.188-.938-.062-.562.031-1.14.281-1.734h.282c.25 0 .546.063.89.188.5.187 1.032.468 1.594.843.781-.218 1.61-.328 2.484-.328.875 0 1.704.11 2.485.328.812-.531 1.515-.86 2.11-.984.26-.052.455-.072.585-.059l.07.012c.25.594.344 1.172.282 1.734 0 .344-.063.657-.188.938.688.75 1.031 1.64 1.031 2.672 0 1.75-.484 3.015-1.453 3.797-.719.593-1.75.968-3.094 1.125.438.406.657 1.03.657 1.875v2.718c0 .157.054.29.164.399.11.11.289.148.539.117z" transform="translate(-358 -1497) translate(0 1332) translate(358 165)"/>
                </g>
            </g>
        </g>
    </g>
</svg></div></a></div><div class="report-header-footer"><span class="footer-text">The KICS project is powered by&nbsp;<a href="https://www.checkmarx.com/" class="checkmarx" rel="noopener" target="_blank">Checkmarx</a>, global leader of Application Security Testing</span></div></div></body></html>